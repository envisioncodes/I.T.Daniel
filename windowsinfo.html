<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">

    <title>I.T.Daniel</title>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
  <a class="navbar-brand" href="#"></a>
<img src="https://cdn.pixabay.com/photo/2020/04/10/20/09/hacker-5027679_960_720.jpg" width="30" height="30" class="d-inline-block align-top" alt="" loading="lazy">
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <div class="navbar-nav">
      <a class="nav-link active" href="#">

        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          I.T.Daniel
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
          <a class="dropdown-item" href="home.html">Home</a>
          <a class="dropdown-item" href="windowsinfo.html">Windows command line</a>
          <a class="dropdown-item" href="#">Something else here</a>
          <a class="dropdown-item" href="#">Action</a>
          <a class="dropdown-item" href="#">Another action</a>
          <a class="dropdown-item" href="#">Something else here</a>
          <a class="dropdown-item" href="#">Action</a>
          <a class="dropdown-item" href="#">Another action</a>
          <a class="dropdown-item" href="#">Something else here</a>
          <a class="dropdown-item" href="#">Action</a>
          <a class="dropdown-item" href="#">Another action</a>
          <a class="dropdown-item" href="#">Something else here</a>
        </div>
      
 
    </div>
  </div>
</nav>

<div class="card-footer bg-dark">
    
  </div>

<div class="card-columns bg-dark">
  <div class="card bg-transparent">

    <img src="https://cdn.pixabay.com/photo/2016/05/08/14/58/icon-1379228_960_720.png" class="card-img-top" alt="...">
    <div class="card-body">
      <h5 class="card-title p-3 text-white">These scripts are present in all Windows versions (starting from Vista and Windows Server 2008) and are located in the directory <strong>C:\Windows\System32\Printing_Admin_Scripts\en-US</strong>.</h5>
      <p class="card-text p-3 text-white">
        <strong>Prncnfg.vbs</strong> – a script to display information about the printer settings;
        <strong>Prndrvr.vbs</strong> – printer driver management (install / uninstall printer drivers);
        <strong>Prnjobs.vbs</strong> – managing print jobs;
        <strong>Prnmngr.vbs</strong> – managing printers (including creating and removing printer in the system)
        <strong>Prnport.vbs</strong> – managing connection to the remote printer via TCP/IP ports;
        <strong>Prnqctl.vbs</strong> – print queue management;
        <strong>Pubprn.vbs</strong> – managing printer publishing in Active Directory.
       </p>
    </div>
  </div>
  <div class="card p-3 text-white bg-dark">
    <blockquote class="blockquote mb-0 card-body">
      <p><strong>Note.</strong> One of the well-known ways of managing printers in different versions of Windows is the host process <strong>rundll32.exe</strong>, which receives the name of the library <strong>printui.dll</strong> and the entry point to it (<strong>PrintUIEntry</strong>). The command <strong>rundll32 printui.dll,PrintUIEntry</strong> is enough to perform basic operations with printers and is fully supported by Microsoft, but the use of specified vbs scripts is preferable from the administrator point of view.</p>
      <footer class="blockquote-footer">
        <small class="text-muted">
          Someone famous in <cite title="Source Title">Source Title</cite>
        </small>
      </footer>
    </blockquote>
  </div>
  <div class="card bg-dark text-white">
    <img src="https://cdn.pixabay.com/photo/2013/07/12/14/48/bash-148836_960_720.png" class="card-img-top" alt="...">
    <div class="card-body">
      <h5 class="card-title">How to Install a Printer Driver from the Command Line?</h5>
      <p class="card-text p-3 font-weight-bolder blockquote mb-0"><code>cscript "C:\Windows\System32\Printing_Admin_Scripts\en-US\prndrvr.vbs" -a -m "HP Universal Printing PCL 6" -i "C:\drv\HP Universal Print Driver\hpcu160u.inf"</code></p>
      <p><strong>-a</strong> – add printer driver;</p>
<p><strong>-m “HP Universal Printing PCL 6”</strong>– the name of the printer driver;</p>
<p><strong>-i “path”</strong> – the full path to the driver&#8217;s INF file.
<p>After the driver is installed, it appears in the print server properties (<strong>Control Panel\Hardware and Sound\Devices and Printers -&gt; </strong><strong>Print Server Properties</strong>).</p>
<strong>Note</strong>. If you are using an incompatible printer driver, you can install it <a href="http://woshub.com/install-incompatible-printer-drivers/">manually</a>
      <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
    </div>
  </div>
  <div class="card bg-dark text-white text-center p-3">
    <blockquote class="blockquote mb-0">
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer posuere erat.</p>
      <footer class="blockquote-footer text-white">
        <small>
          Someone famous in <cite title="Source Title">Source Title</cite>
        </small>
      </footer>
    </blockquote>
  </div>
  <div class="card bg-dark text-white">
    <div class="card-body">
      <h5 class="card-title">How to Add a New Printer from the Command Prompt?</h5>
      <p class="card-text font-weight-bolder blockquote mb-0"><code>cscript "C:\Windows\System32\Printing_Admin_Scripts\en-US\prnmngr.vbs" -a -p "HP5520" -m "HP Universal Printing PCL 6" -r "lpt1:"</code></p>
<p><strong>-a</strong> – a new local printer is installed;</p>
<p><strong>-p “HP5520”</strong> – a display name of the printer;</p>
<p><strong>-m “HP Universal Printing PCL 6”</strong> – a print driver that is used;						
<p><strong>-r “lpt1:”</strong> – a name of the local print port used. In this case, printing should be performed through the LPT port. Here you can specify the parallel port (LPT1:, LPT2:), serial (COM1:, COM2: &#8211; before installation, make sure that this <a href="http://woshub.com/how-to-clean-up-and-reset-com-ports-in-windows-7/">COM port is not used</a> by another device) or USB port (USB001, etc.).</p>
      <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
    </div>
  </div>
  <div class="card bg-dark text-white">
    <img src="https://cdn.pixabay.com/photo/2016/03/31/18/38/icons-1294522_960_720.png" class="card-img-top" alt="...">
  </div>
  <div class="card bg-dark text-white">
    <blockquote class="font-weight-bolder blockquote mb-0">
      <p>Managing Default Printer Using CMD</p>
<p>From the command line, you can choose which printer to use for default printing. With the following command you can list all installed printers:</p>
    <code>cscript "C:\Windows\System32\Printing_Admin_Scripts\en-US\prnmngr.vbs" –l</code>
<p>Get the name of the default printer.</p>

<p><code>cscript "C:\Windows\System32\Printing_Admin_Scripts\en-US\prnmngr.vbs" –g</code></p>
<p>To set a different default printer, run the command:</p>
<p><code>cscript "C:\Windows\System32\Printing_Admin_Scripts\en-US\prnmngr.vbs" -t –p "HP5525"</code></p>

      <footer class="blockquote-footer">
        <small class="text-muted">
          Someone famous in <cite title="Source Title">Source Title</cite>
        </small>
      </footer>
    </blockquote>
  </div>
  <div class="card bg-dark text-white font-weight-bolder blockquote mb-0">
    <div class="card-body">
      <h5 class="card-title">How to Create a TCP/IP Port for a Network Printer?</h5>
      <p class="card-text">
    <code>cscript "C:\Windows\System32\Printing_Admin_Scripts\en-US\Prnport.vbs" -a -r IP_192.168.1.22 -h 192.168.1.22 -o raw -n 9100</code>
<p></p>
<br><strong>-r IP_192.168.1.22</strong> – a name of the network port;</p>
<p><strong>-h 192.168.1.22</strong> – IP address of the device;</p>
<p><strong>-o raw</strong> – a port type (raw or lpr);</p>
<p><strong>-n 9100</strong> – the number of the TCP port of the device (usually 9100).</p>
<p>

And then you can install a new network printer on the system:</p>
<code>cscript "C:\Windows\System32\Printing_Admin_Scripts\en-US\prnmngr.vbs" -a -p "HP5525" -m "HP Universal Printing PCL 6" -r " IP_192.168.1.22"</code><br />
<p>After the script is over, a new printer HP5525 appears in the system.</p>
    </p>
      <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
    </div>
  </div>





<div class="card bg-dark text-white font-weight-bolder blockquote mb-0">
    <div class="card-body">
      <h5 class="card-title">How to Print a Test Page from the CMD?</h5>
      <p class="card-text font-weight-bolder blockquote mb-0">
<p>To print a test page on the printer you have created, do the following:</p>
    <code>cscript "C:\Windows\System32\Printing_Admin_Scripts\en-US\prnqctl.vbs” -e -p "HP5525"</code>


    </p>
      <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
    </div>
  </div>



<div class="card bg-dark text-white font-weight-bolder blockquote mb-0">
    <div class="card-body">
      <h5 class="card-title">Manage Print Queues from the Command Prompt</h5>
      <p class="card-text">
<p>Using the prnjobs.vbs script, you can view print jobs in queues. To display all print jobs for all local printers, run the command:</p>
<code>cscript "C:\Windows\System32\Printing_Admin_Scripts\en-US\prnjobs.vbs” –l</code></p>
<p>To display jobs on a specific printer, you need to specify its name:</p>
<p><code>cscript "C:\Windows\System32\Printing_Admin_Scripts\en-US\prnjobs.vbs” –l –p HP5525</code></p>
<p>To clear the print queue on one printer, run the following command:</p>
<p><code>cscript "C:\Windows\System32\Printing_Admin_Scripts\en-US\prnjobs.vbs” –x –p HP5525</code></p>
<p>Or you can quickly clear all queues for all printers (this is much more convenient than manually cleaning the print queues):</p>
<p><code>cscript "C:\Windows\System32\Printing_Admin_Scripts\en-US\prnjobs.vbs” –x</code></p>
      <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
    </div>
  </div>





<div class="card bg-dark text-white font-weight-bolder blockquote mb-0">
    <div class="card-body">
      <h5 class="card-title">Share a Network Printer Using the Command Line</h5>
      <p class="card-text">
<p>All new printers that you installed in Windows from the command prompt are local. You can share them with other users over the network from the Windows GUI (see the <a href="http://woshub.com/sharing-files-printers-without-homegroup-windows-10/#h2_3">article</a>). You can also share the printer from the command line. For example, you want to provide network access to your HP5525 printer by publishing it under the name HP5525_Shared. Use the command:</p>
    <p><code>cscript "C:\Windows\System32\Printing_Admin_Scripts\en-US\prncnfg.vbs” -t  -p  HP5525 -h "HP5525_Shared" +shared</code></p>
<p>To disable printer sharing, run:</p>
<p><code>cscript "C:\Windows\System32\Printing_Admin_Scripts\en-US\prncnfg.vbs” -t -p "HP5525" -shared</code></p>
<p>Similarly, you can publish a printer in Active Directory:</p>
<p><code>cscript "C:\Windows\System32\Printing_Admin_Scripts\en-US\prncnfg.vbs” -t  -p HP5525 +published</code></p>


<p>To remove printer from the AD, use the &#8220;<strong>-published</strong>&#8221; argument.</p>


      <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
    </div>
  </div>





<div class="card bg-dark text-white font-weight-bolder blockquote mb-0">
    <div class="card-body">
      <h5 class="card-title">How to Add a Network Printer via the Command Line?</h5>
      <p class="card-text">
<p>To connect a shared network printer connected to another computer, use the
command:</p>
<p><code>cscript "C:\Windows\System32\Printing_Admin_Scripts\en-US\prnmngr.vbs" -ac -p “\\rome-prnt01\hp2100”</code><p>


      <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
    </div>
  </div>




<div class="card bg-dark text-white font-weight-bolder blockquote mb-0">
    <div class="card-body">
      <h5 class="card-title">How to Remove a Printer and Its Driver from the Command Prompt?</h5>
      <p class="card-text">
<p>A complete list of printers in the system can be displayed as:</p>
<p><code>cscript "C:\Windows\System32\Printing_Admin_Scripts\en-US\prnmngr.vbs" -l</code></p>
<p>A printer can be removed with the following command:</p>
<code>cscript "C:\Windows\System32\Printing_Admin_Scripts\en-US\prnmngr.vbs" -d -p "HP5525"</code><br />
<p>The print driver is deleted as follows:</p>
<code>cscript "C:\Windows\System32\Printing_Admin_Scripts\en-US\prndrvr.vbs" -d -m "HP Universal Printing PCL 6" -e "Windows x64" -v 3</code></p>	      

      <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
    </div>
  </div>



</div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
  </body>
</html>
